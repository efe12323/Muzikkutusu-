<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>M√ºzik Kutusu</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = { theme: { extend: { colors: { primary: '#1DB954', dark: '#121212' }}}}
</script>
</head>
<body class="bg-dark text-white font-sans">

<!-- HEADER -->
<header class="flex justify-between items-center p-4 bg-neutral-900 shadow-lg">
  <h1 class="text-2xl font-bold text-primary">üéµ M√ºzik Kutusu</h1>
  <button onclick="openAdminModal()" class="px-3 py-1 bg-primary text-black rounded-lg hover:bg-green-400">Admin</button>
</header>

<!-- A√áIKLAMA -->
<div class="text-center mt-4 mb-6 text-gray-300">
  <p class="text-lg">T√ºrkiye‚Äônin %100 √ºcretsiz telifsiz m√ºzik platformu</p>
</div>

<!-- ARAMA VE Fƒ∞LTRE -->
<div class="flex flex-wrap justify-center gap-3 mb-6 px-4">
  <input id="search" oninput="renderMusics()" placeholder="üîç Ba≈ülƒ±ƒüa g√∂re ara..." class="bg-neutral-800 p-2 rounded-lg w-64 outline-none">
  <select id="filter" onchange="renderMusics()" class="bg-neutral-800 p-2 rounded-lg">
    <option value="all">T√ºm√º</option>
    <option value="Rap">Rap</option>
    <option value="Chill">Chill</option>
    <option value="Rock">Rock</option>
    <option value="Anadolu Rock">Anadolu Rock</option>
  </select>
</div>

<!-- M√úZƒ∞K KARTLARI -->
<div id="musicList" class="grid grid-cols-2 md:grid-cols-4 gap-4 px-4 mb-24"></div>

<!-- PLAYER -->
<div id="player" class="fixed bottom-0 left-0 right-0 bg-neutral-900 p-3 border-t border-neutral-700 hidden">
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-3">
      <img id="playerCover" src="" class="w-12 h-12 rounded-md">
      <div>
        <p id="playerTitle" class="font-semibold"></p>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button onclick="prevMusic()">‚èÆÔ∏è</button>
      <button id="playPause" onclick="togglePlay()">‚ñ∂Ô∏è</button>
      <button onclick="nextMusic()">‚è≠Ô∏è</button>
      <a id="downloadBtn" href="#" download class="ml-2">‚¨áÔ∏è</a>
    </div>
  </div>
</div>

<!-- ADMIN MODAL -->
<div id="adminModal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center">
  <div class="bg-neutral-900 p-6 rounded-xl w-96 shadow-2xl">
    <h2 class="text-xl font-bold text-primary mb-4">Admin Giri≈üi</h2>
    <div id="adminLogin">
      <input type="password" id="adminPass" placeholder="≈ûifre giriniz" class="w-full p-2 rounded bg-neutral-800 mb-3 outline-none">
      <button onclick="checkAdmin()" class="w-full bg-primary text-black py-2 rounded font-bold hover:bg-green-400">Giri≈ü</button>
    </div>
    <div id="adminPanel" class="hidden">
      <h3 class="text-lg mb-3 font-semibold">Yeni M√ºzik Ekle</h3>
      <input id="musicTitle" type="text" placeholder="Ba≈ülƒ±k" class="w-full p-2 mb-2 rounded bg-neutral-800 outline-none">
      <input id="musicTags" type="text" placeholder="Etiketler (virg√ºlle ayƒ±r)" class="w-full p-2 mb-2 rounded bg-neutral-800 outline-none">
      <label class="text-gray-400 text-sm">Kapak Fotoƒürafƒ±</label>
      <input id="musicCover" type="file" accept="image/*" class="w-full mb-2">
      <label class="text-gray-400 text-sm">MP3 Dosyasƒ±</label>
      <input id="musicFile" type="file" accept="audio/*" class="w-full mb-3">
      <button onclick="uploadMusic()" class="w-full bg-primary text-black py-2 rounded font-bold hover:bg-green-400">Y√ºkle</button>
      <button onclick="closeAdminModal()" class="w-full mt-2 bg-neutral-800 text-gray-300 py-2 rounded hover:bg-neutral-700">Kapat</button>
      <p id="status" class="text-center text-sm text-gray-400 mt-2">Hazƒ±r</p>
    </div>
  </div>
</div>

<script>
// Cloudinary Bilgileri
const CLOUD_NAME = "dq4iighak";
const UPLOAD_PRESET = "music_upload";

// Global Deƒüi≈ükenler
let musics = [];
let currentIndex = 0;
let audio = new Audio();
let adminPass = "efe12345efe";

// Cloudinary y√ºkleme fonksiyonu
function uploadToCloudinary(file, type){
  const url = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/${type}/upload`;
  const data = new FormData();
  data.append("file", file);
  data.append("upload_preset", UPLOAD_PRESET);
  return fetch(url,{method:"POST",body:data}).then(r=>r.json());
}

// Admin login
function openAdminModal(){ document.getElementById('adminModal').classList.remove('hidden'); }
function closeAdminModal(){ document.getElementById('adminModal').classList.add('hidden'); }
function checkAdmin(){
  const pass = document.getElementById("adminPass").value;
  if(pass === adminPass){
    document.getElementById("adminLogin").classList.add("hidden");
    document.getElementById("adminPanel").classList.remove("hidden");
  } else alert("Yanlƒ±≈ü ≈üifre!");
}

// M√ºzik y√ºkleme
async function uploadMusic(){
  const title = document.getElementById("musicTitle").value;
  const tags = document.getElementById("musicTags").value;
  const cover = document.getElementById("musicCover").files[0];
  const file = document.getElementById("musicFile").files[0];
  if(!title || !tags || !cover || !file){ alert("T√ºm alanlarƒ± doldur!"); return; }

  document.getElementById("status").innerText="Y√ºkleniyor...";
  const coverRes = await uploadToCloudinary(cover,"image");
  const musicRes = await uploadToCloudinary(file,"video");
  musics.push({title, tags, cover_url:coverRes.secure_url, audio_url:musicRes.secure_url});
  localStorage.setItem("musics", JSON.stringify(musics));
  document.getElementById("status").innerText="Y√ºklendi!";
  renderMusics();
}

// Listeleme
function renderMusics(){
  const list = document.getElementById("musicList");
  list.innerHTML="";
  const search = document.getElementById("search").value.toLowerCase();
  const filter = document.getElementById("filter").value;
  musics
    .filter(m=>m.title.toLowerCase().includes(search) && (filter==="all"||m.tags.includes(filter)))
    .forEach((m,i)=>{
      const card=document.createElement("div");
      card.className="bg-neutral-800 p-3 rounded-xl hover:bg-neutral-700 transition cursor-pointer";
      card.onclick=()=>playMusic(i);
      card.innerHTML=`
        <img src="${m.cover_url}" class="rounded-lg mb-2 w-full h-40 object-cover">
        <h3 class="font-bold">${m.title}</h3>
        <p class="text-sm text-gray-400">${m.tags}</p>
      `;
      list.appendChild(card);
    });
}

// Player
function playMusic(index){
  currentIndex=index;
  const m=musics[index];
  document.getElementById("playerCover").src=m.cover_url;
  document.getElementById("playerTitle").innerText=m.title;
  document.getElementById("downloadBtn").href=m.audio_url;
  document.getElementById("player").classList.remove("hidden");
  audio.src=m.audio_url;
  audio.play();
  document.getElementById("playPause").innerText="‚è∏Ô∏è";
}
function togglePlay(){
  if(audio.paused){audio.play();document.getElementById("playPause").innerText="‚è∏Ô∏è";}
  else{audio.pause();document.getElementById("playPause").innerText="‚ñ∂Ô∏è";}
}
function nextMusic(){ if(currentIndex<musics.length-1) playMusic(currentIndex+1); }
function prevMusic(){ if(currentIndex>0) playMusic(currentIndex-1); }

// LocalStorage‚Äôdan m√ºzikleri y√ºkle
window.onload=()=>{musics=JSON.parse(localStorage.getItem("musics")||"[]");renderMusics();}
</script>
</body>
</html>
