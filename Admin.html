<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Admin Paneli</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.1/dist/umd/supabase.js"></script>

<style>
  body { background:#0c0c0c; }
</style>
</head>

<body class="text-white p-6">

<h1 class="text-3xl font-bold">ğŸ” Admin Paneli</h1>

<!-- Login Box -->
<div id="loginBox" class="mt-6 bg-neutral-900 p-5 rounded-lg max-w-sm">
  <p class="mb-2">Admin ÅŸifresi:</p>
  <input id="adminPass" type="password" class="bg-neutral-800 p-2 rounded w-full">
  <button onclick="login()" class="mt-3 bg-blue-600 rounded p-2 w-full">GiriÅŸ Yap</button>
</div>

<!-- Panel -->
<div id="panel" class="hidden mt-6">

  <h2 class="text-2xl font-bold mb-4">Yeni MÃ¼zik Ekle</h2>

  <input id="title" placeholder="BaÅŸlÄ±k" class="p-2 bg-neutral-900 rounded w-full mb-2">
  <input id="tags" placeholder="Etiketler (virgÃ¼llÃ¼)" class="p-2 bg-neutral-900 rounded w-full mb-2">

  <label class="block mt-2 mb-1">MP3:</label>
  <input id="audio" type="file" accept="audio/mp3" class="mb-3">

  <label class="block mt-2 mb-1">Kapak Resmi:</label>
  <input id="cover" type="file" accept="image/*" class="mb-4">

  <button onclick="uploadMusic()" class="bg-green-600 p-2 rounded w-full">MÃ¼ziÄŸi YÃ¼kle</button>

  <h2 class="text-2xl font-bold mt-8 mb-4">YÃ¼klÃ¼ MÃ¼zikler</h2>
  <div id="adminList" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>

</div>

<script>
const ADMIN_PASSWORD = "efe12345efe";

const client = supabase.createClient(
 "https://jzidtvylnrolmmlaegyr.supabase.co",
 "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp6aWR0dnlsbnJvbG1tbGFlZ3lyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwMDQ4ODgsImV4cCI6MjA4MDU4MDg4OH0.S61VHALTStNxq2RY4B2GhrAuELTtgycsTrTw5cH04EA"
);

function login(){
  const pass = document.getElementById("adminPass").value;
  if(pass !== ADMIN_PASSWORD){
    alert("YanlÄ±ÅŸ ÅŸifre!");
    return;
  }
  document.getElementById("loginBox").style.display = "none";
  document.getElementById("panel").classList.remove("hidden");
  loadAdminList();
}

async function uploadMusic(){
  const title = document.getElementById("title").value;
  const tags = document.getElementById("tags").value;
  const audio = document.getElementById("audio").files[0];
  const cover = document.getElementById("cover").files[0];

  if(!title || !tags || !audio || !cover){
    alert("TÃ¼m alanlarÄ± doldurun!");
    return;
  }

  const audioName = "audio_" + Date.now() + ".mp3";
  const coverName = "cover_" + Date.now() + ".jpg";

  await client.storage.from("music").upload(audioName, audio);
  await client.storage.from("music").upload(coverName, cover);

  const audioURL = `https://jzidtvylnrolmmlaegyr.supabase.co/storage/v1/object/public/music/${audioName}`;
  const coverURL = `https://jzidtvylnrolmmlaegyr.supabase.co/storage/v1/object/public/music/${coverName}`;

  await client.from("musics").insert({
    title, tags, audio_url: audioURL, cover_url: coverURL
  });

  alert("MÃ¼zik baÅŸarÄ±yla yÃ¼klendi!");
  loadAdminList();
}

async function loadAdminList(){
  const { data } = await client.from("musics").select("*");
  const box = document.getElementById("adminList");
  box.innerHTML = "";

  data.forEach(m => {
    box.innerHTML += `
      <div class="bg-neutral-900 p-3 rounded-lg">
        <img src="${m.cover_url}" class="w-full h-28 object-cover rounded">
        <p class="mt-2 font-semibold">${m.title}</p>
        <p class="text-xs text-neutral-400">${m.tags}</p>
        <button onclick="deleteMusic(${m.id})"
                class="bg-red-600 w-full p-1 rounded mt-2">Sil</button>
      </div>
    `;
  });
}

async function deleteMusic(id){
  if(!confirm("Bu mÃ¼ziÄŸi silmek istediÄŸine emin misin?")) return;
  await client.from("musics").delete().eq("id", id);
  loadAdminList();
}
</script>

</body>
</html>
